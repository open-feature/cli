// Code generated by OpenFeature cli. DO NOT EDIT.
// cli version: {{ .Params.Custom.CliVersion }}

// Package {{ .Params.Custom.GoPackage }} contains generated code produced by the OpenFeature cli.
package {{ .Params.Custom.GoPackage }}

import (
{{- range $_, $p := SupportImports .Flagset.Flags}}
	{{$p}}
{{- end}}
)

// stringer transforms a string to a Stringer
type stringer string

// String implements the fmt.Stringer interface
func (s stringer) String() string {
	return string(s)
}

type (
	evaluationValue[T any]   func(context.Context, openfeature.EvaluationContext) (T, error)
	evaluationDetails[T any] func(context.Context, openfeature.EvaluationContext) (openfeature.GenericEvaluationDetails[T], error)
)

var client openfeature.IClient = nil

{{- range .Flagset.Flags }}
// {{ .Key | ToPascal }} - {{ if .Description }}{{ .Description }}{{ else }}Feature flag{{ end }}
var {{ .Key | ToPascal }} = struct {
	fmt.Stringer
	// Value returns the value of the flag {{ .Key | ToPascal }},
	// as well as the evaluation error, if present.
	Value evaluationValue[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}]

	// ValueWithDetails returns the value of the flag {{ .Key | ToPascal }},
	// the evaluation error, if any, and the evaluation details.
	ValueWithDetails evaluationDetails[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}]
}{
		Stringer: stringer({{ .Key | Quote }}),
	 Value: func(ctx context.Context, evalCtx openfeature.EvaluationContext) ({{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}, error) {
	     return client.{{ .Type | OpenFeatureType }}Value(ctx, {{ .Key | Quote }}, {{ if eq (.Type | OpenFeatureType)  "Object" }}{{.DefaultValue | ToMapLiteral }}{{- else }}{{ .DefaultValue | QuoteString }}{{- end}}, evalCtx)
	 },
	 ValueWithDetails: func(ctx context.Context, evalCtx openfeature.EvaluationContext) (openfeature.GenericEvaluationDetails[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}], error){
	     return client.{{ .Type | OpenFeatureType }}ValueDetails(ctx, {{ .Key | Quote }}, {{ if eq (.Type | OpenFeatureType)  "Object" }}{{.DefaultValue | ToMapLiteral }}{{- else }}{{ .DefaultValue | QuoteString }}{{- end}}, evalCtx)
	 },
}
{{- end}}

func init() {
	client = openfeature.NewDefaultClient()
}
