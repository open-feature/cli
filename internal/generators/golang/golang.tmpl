// Code generated by OpenFeature CLI. DO NOT EDIT.
// CLI version: {{ .Params.Custom.CLIVersion }}

// Package {{ .Params.Custom.GoPackage }} contains generated code produced by the OpenFeature CLI.
package {{ .Params.Custom.GoPackage }}

import (
{{- range $_, $p := SupportImports .Flagset.Flags}}
	{{$p}}
{{- end}}
)

// stringer transforms a string to a Stringer
type stringer string

// String implements the fmt.Stringer interface
func (s stringer) String() string {
	return string(s)
}

type (
	evaluationValue[T any]   func(context.Context, openfeature.EvaluationContext) T
	evaluationDetails[T any] func(context.Context, openfeature.EvaluationContext) (openfeature.GenericEvaluationDetails[T], error)
)

var client = openfeature.NewDefaultClient()

{{- range .Flagset.Flags }}
// {{ .Key | ToPascal }} returns the value of the "{{ .Key }}" feature flag.
// {{ if .Description }}{{ .Description }}{{ end }}
//
// The flag is a type of {{ .Type }} and defaults to {{ .DefaultValue }}.
var {{ .Key | ToPascal }} = struct {
	fmt.Stringer
	// Value returns the value of the [{{ .Key | ToPascal }}] flag.
	Value evaluationValue[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}]

	// ValueWithDetails returns the evaluation details of the [{{ .Key | ToPascal }}] flag
  // and the evaluation error, if any.
	ValueWithDetails evaluationDetails[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}]
}{
		Stringer: stringer({{ .Key | Quote }}),
	 Value: func(ctx context.Context, evalCtx openfeature.EvaluationContext) {{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}} {
	     return client.{{ .Type | OpenFeatureType }}(ctx, {{ .Key | Quote }}, {{ if eq (.Type | OpenFeatureType)  "Object" }}{{.DefaultValue | ToMapLiteral }}{{- else }}{{ .DefaultValue | QuoteString }}{{- end}}, evalCtx)
	 },
	 ValueWithDetails: func(ctx context.Context, evalCtx openfeature.EvaluationContext) (openfeature.GenericEvaluationDetails[{{- if eq (.Type | OpenFeatureType)  "Object"}}any{{- else}}{{ .Type | TypeString }}{{- end}}], error){
	     return client.{{ .Type | OpenFeatureType }}ValueDetails(ctx, {{ .Key | Quote }}, {{ if eq (.Type | OpenFeatureType)  "Object" }}{{.DefaultValue | ToMapLiteral }}{{- else }}{{ .DefaultValue | QuoteString }}{{- end}}, evalCtx)
	 },
}
{{- end}}
